var Benchmark = require('benchmark');
var suite = new Benchmark.Suite();
var assert = require('assert');
var termops = require('../lib/util/termops');
var token = require('../lib/util/token');
var tape = require('tape');

module.exports = benchmark;

function benchmark(cb) {
    if (!cb) cb = function() {};
    console.log('# replace tokens');

    suite.add('Permutations all together of 1 token', function() {
        var replacer = token.createReplacer({'Street':'St', 'North':'N'});
        assert.deepEqual(termops.replaceTokenPermutations(replacer, 'North Main Street').sort(), ['North Main Street', 'N Main St', 'North Main St', 'N Main Street'].sort()
        );
    })
    .add('Permutation all together of 3 tokens', function() {
        replacer = token.createReplacer({'Street':'St', 'North':'N', 'Main':'Mn'});
        assert.deepEqual(termops.replaceTokenPermutations(replacer, 'North Main Street').sort(), ['North Main Street', 'N Mn St','N Main St', 'N Mn Street','North Main St', 'N Main Street', 'North Mn Street'].sort());
    })
    .add('##### WITHOUT XREGEXP:\n SPLIT(1)create token replacer', function() {
        replacer = token.createReplacer({'First': '1st','Second': '2nd','Third': '3rd','Fourth': '4th','Fifth': '5th','Sixth': '6th','Seventh': '7th','Eigth': '8th','Ninth': '9th','Tenth': '10th','Eleventh': '11th','Twelfth': '12th','Thirteenth': '13th','Fourteenth': '14th','Fifteenth': '15th','Sixteenth': '16th','Seventeenth': '17th','Eighteenth': '18th','Nineteenth': '19th','Twentieth': '20th','Alley': 'Aly','Arcade': 'Arc','Avenue': 'Ave','Bayoo': 'Byu','Beach': 'Bch','Bluff': 'Blf','Bottom': 'Btm','Boulevard': 'Blvd','Branch': 'Br','Bridge': 'Brg','Brook': 'Brk','Brooks': 'Brks','Burg': 'Bg','Burgs': 'Bgs','Bypass': 'Byp','Calle': 'Cll','Camp': 'Cp','Canyon': 'Cyn','Cape': 'Cpe','Causeway': 'Cswy','Center': 'Ctr','Centers': 'Ctrs','Circle': 'Cir','Circles': 'Cirs','Cliff': 'Clf','Cliffs': 'Clfs','Club': 'Clb','Common': 'Cmn','Corner': 'Cor','Course': 'Crse','Court': 'Ct','Courts': 'Cts','Cove': 'Cv','Creek': 'Crk','Crescent': 'Cres','Crest': 'Crst','Crossing': 'Xing','Curve': 'Curv','Dale': 'Dl','Dam': 'Dm','Divide': 'Dv','Drive': 'Dr','Drives': 'Drs','East': 'E','Estate': 'Est','Estates': 'Ests','Expressway': 'Expy','Extension': 'Ext','Extensions': 'Exts','Falls': 'Fls','Ferry': 'Fry','Field': 'Fld','Fields': 'Flds','Flat': 'Flt','Flats': 'Flts','Ford': 'Frd','Forest': 'Frst','Forge': 'Frg','Forges': 'Frgs','Fork': 'Frk','Fort': 'Ft','Freeway': 'Fwy','Grade': 'Grd','Green': 'Grn','Harbor': 'Hbr','Harbors': 'Hbrs','Haven': 'Hvn','Heights': 'Hts','Highway': 'Hwy','Hill': 'Hl','Hills': 'Hls','Hollow': 'Holw','Industrial': 'Ind','Interstate': 'I','Island': 'Is','Islands': 'Iss','Junction': 'Jct','Junctions': 'Jcts','Junior': 'Jr','Key': 'Ky','Keys': 'Kys','Knoll': 'Knl','Knolls': 'Knls','Lake': 'Lk','Lakes': 'Lks','Landing': 'Lndg','Lane': 'Ln','Lieutenant': 'Lt','Light': 'Lgt','Lights': 'Lgts','Loaf': 'Lf','Lock': 'Lck','Locks': 'Lcks','Lodge': 'Ldg','Mall': 'Mal','Manor': 'Mnr','Manors': 'Mnrs','Meadow': 'Mdw','Meadows': 'Mdws','Mill': 'Ml','Mission': 'Msn','Moorhead': 'Mhd','Motorway': 'Mtwy','Mountain': 'Mtn','Mount': 'Mt','Neck': 'Nck','Northeast': 'NE','North': 'N','Northwest': 'NW','Orchard': 'Orch','Overpass': 'Ovps','Parkway': 'Pky','Passage': 'Psge','Place': 'Pl','Plain': 'Pln','Plains': 'Plns','Plaza': 'Plz','Point': 'Pt','Points': 'Pts','Port': 'Prt','Ports': 'Prts','Prairie': 'Pr','Private': 'Pvt','Radial': 'Radl','Ranch': 'Rnch','Rapid': 'Rpd','Rapids': 'Rpds','Rest': 'Rst','Ridge': 'Rdg','Ridges': 'Rdgs','River': 'Riv','Road': 'Rd','Roads': 'Rds','Route': 'Rte','Saint': 'St','Senior': 'Sr','Sergeant': 'Sgt','Shoal': 'Shl','Shoals': 'Shls','Shore': 'Shr','Shores': 'Shrs','Skyway': 'Sky','Southeast': 'SE','South': 'S','Southwest': 'SW','Spring': 'Spg','Springs': 'Spgs','Square': 'Sq','Squares': 'Sqs','Station': 'Sta','Stream': 'Strm','Streets': 'Sts','Street': 'St','Summit': 'Smt','Terrace': 'Ter','Thoroughfare': 'Thfr','Thruway': 'Thwy','Trace': 'Trce','Trafficway': 'Tfwy','Trail': 'Trl','Tunnel': 'Tunl','Turnpike': 'Tpke','Underpass': 'Unp','Unions': 'Uns','Union': 'Un','Valleys': 'Vlys','Valley': 'Vly','Viaduct': 'Via','Views': 'Vws','View': 'Vw','Villages': 'Vlgs','Village': 'Vlg','Ville': 'Vl','Vista': 'Vis','Walkway': 'Wlky','West': 'W','San Francisco': 'sf'});
    })
    .add('SPLIT (2): filtering tokens', function() {
        token.tokenReplacerFilter(replacer,'North Main Street');
    })
    .add('SPLIT (3): Permutation of US index tokens without XRegexp', function() {
        assert.deepEqual(termops.replaceTokenPermutations(replacer, 'North Main Street').sort(), [ 'N Main St','N Main Street','North Main St','North Main Street' ]);
    })
    .add('##### WITH XREGEXP\nSPLIT(1)create token replacer', function() {
        replacer = token.createReplacer({"Tenth": "10th","Eleventh": "11th","Twelfth": "12th","Thirteenth": "13th","Fourteenth": "14th","Fifteenth": "15th","Sixteenth": "16th","Seventeenth": "17th","Eighteenth": "18th","Nineteenth": "19th","First": "1st","Twentieth": "20th","Second": "2nd","Third": "3rd","Fourth": "4th","Fifth": "5th","Sixth": "6th","Seventh": "7th","Eigth": "8th","Ninth": "9th","Access": "Accs","Alleyway": "Alwy","Ally": "Aly","Alley": "Aly","Amble": "Ambl","Approach": "App","Apartment": "Apt","Apartments": "Apts","Arcade": "Arc","Arterial": "Artl","Artery": "Arty","Avenue": "Ave","Banan": "Ba","Beach": "Bch","Burg": "Bg","Burgs": "Bgs","Bluff": "Blf","Block": "Blk","Brace": "Br","Branch": "Br","Bridge": "Brg","Break": "Brk","Brook": "Brk","Brooks": "Brks","Bottom": "Btm","Blvd": "Bvd","Boulevard": "Bvd","Boardwalk": "Bwlk","Bypa": "Byp","Bypass": "Byp","Bayou": "Byu","Byway": "Bywy","Bazaar": "Bzr","Cantonment": "Cantt","Circuit": "Cct","Chase": "Ch","Church": "Ch","Chowk": "Chk","Circle": "Cir","Circles": "Cirs","Close": "Cl","Clinic": "Cl","Club": "Clb","Cliff": "Clf","Cliffs": "Clfs","Calle": "Cll","Colony": "Cly","Common": "Cmn","Canal": "Cnl","Cor": "Cnr","Corner": "Cnr","College": "Coll","Concourse": "Con","Constituency": "Const","Corporation": "Corpn","Camp": "Cp","Cape": "Cpe","Complex": "Cplx","Copse": "Cps","Circus": "Crcs","Creek": "Crk","Course": "Crse","Crest": "Crst","Cul-de-sac": "Csac","Causeway": "Cswy","Court": "Ct","Center": "Ctr","Centre": "Ctr","Centers": "Ctrs","Courts": "Cts","Courtyard": "Ctyd","Curve": "Curv","Cutting": "Cutt","Cove": "Cv","Canyon": "Cyn","Dale": "Dl","Dam": "Dm","Drive": "Dr","Drives": "Drs","District": "Dt","Divide": "Dv","Driveway": "Dvwy","East": "E","Elbow": "Elb","Entrance": "Ent","Esplanade": "Esp","Estate": "Est","Estates": "Ests","Expy": "Exp","Expressway": "Exp","Extension": "Ext","Extensions": "Exts","Fairway": "Fawy","Field": "Fld","Fields": "Flds","Falls": "Fls","Flat": "Flt","Flats": "Flts","Follow": "Folw","Formation": "Form","Ford": "Frd","Forge": "Frg","Forges": "Frgs","Fork": "Frk","Forest": "Frst","Frontage": "Frtg","Ferry": "Fry","Feet": "Ft","Fort": "Ft","Footway": "Ftwy","Freeway": "Fwy","Gardens": "Gdns","General": "Gen","Galli": "Gl","Glade": "Glde","Government": "Govt","Grove": "Gr","Grange": "Gra","Grade": "Grd","Green": "Grn","Gate": "Gte","Harbor": "Hbr","Harbors": "Hbrs","Highroad": "Hird","Hill": "Hl","Hills": "Hls","Hollow": "Holw","Hospital": "Hosp","Hotel": "Htl","Heights": "Hts","Haven": "Hvn","Highway": "Hwy","Interstate": "I","Industrial": "Ind","Interchange": "Intg","Island": "Is","Islands": "Iss","Junctions": "Jcts","Jct": "Jn","Jnc": "Jn","Junction": "Jn","Junior": "Jr","Knoll": "Knl","Knolls": "Knls","Key": "Ky","Keys": "Kys","Lock": "Lck","Locks": "Lcks","Lodge": "Ldg","Loaf": "Lf","Light": "Lgt","Lights": "Lgts","Lake": "Lk","Lakes": "Lks","Lookout": "Lkt","Lane": "Ln","Landing": "Lndg","Laneway": "Lnwy","Lieutenant": "Lt","Layout": "Lyt","Major": "Maj","Mall": "Mal","Municpality": "Mcplty","Meadow": "Mdw","Meadows": "Mdws","Marg": "Mg","Moorhead": "Mhd","Market": "Mkt","Mill": "Ml","Meander": "Mndr","Manor": "Mnr","Manors": "Mnrs","Mosque": "Mq","Mission": "Msn","Mount": "Mt","Mountain": "Mtn","Motorway": "Mtwy","North": "N","Neck": "Nck","Northeast": "NE","Nagar": "Ngr","Nalla": "Nl","Northwest": "NW","Office": "Off","Orchard": "Orch","Outlook": "Otlk","Overpass": "Ovps","Panchayat": "Pchyt","Parade": "Pde","Platform": "Pf","Phase": "Ph","Piazza": "Piaz","Peak": "Pk","Pocket": "Pkt","Place": "Pl","Plain": "Pln","Plains": "Plns","Plza": "Plz","Plaza": "Plz","Post Office": "Po","Prairie": "Pr","Promenade": "Prom","Port": "Prt","Ports": "Prts","Passage": "Psge","Pnt": "Pt","Point": "Pt","Points": "Pts","Private": "Pvt","Pathway": "Pway","Pkwy": "Pwy","Parkway": "Pwy","Quadrant": "Qdrt","Quarters": "Qtrs","Quays": "Qys","Riv": "R","River": "R","Radial": "Radl","Road": "Rd","Rdge": "Rdg","Ridge": "Rdg","Ridges": "Rdgs","Roads": "Rds","Railway": "Rly","Ramble": "Rmbl","Ranch": "Rnch","Rapid": "Rpd","Rapids": "Rpds","Railway Station": "Rs","Rest": "Rst","Restaurant": "Rt","Route": "Rte","Retreat": "Rtt","Rotary": "Rty","South": "S","Subway": "Sbwy","School": "Sch","Southeast": "SE","Sergeant": "Sgt","Shoal": "Shl","Shoals": "Shls","Shore": "Shr","Shores": "Shrs","Shunt": "Shun","Skyway": "Skwy","Summit": "Smt","Spring": "Spg","Springs": "Spgs","Square": "Sq","Squares": "Sqs","Senior": "Sr","Saint": "St","Street": "St","Stn": "Sta","Station": "Sta","Stadium": "Std","Stage": "Stg","Stream": "Strm","Streets": "Sts","Serviceway": "Svwy","Southwest": "SW","Ter": "Tce","Terrace": "Tce","Trafficway": "Tfwy","Thoroughfare": "Thfr","Thruway": "Thwy","Tollway": "Tlwy","Turnpike": "Tpke","Temple": "Tpl","Trace": "Trce","Track": "Trk","Trail": "Trl","Tunnel": "Tunl","Town": "Twn","Union": "Un","University": "Univ","Upas": "Unp","Underpass": "Unp","Unions": "Uns","Viad": "Via","Viaduct": "Via","Vsta": "Vis","Vista": "Vis","Ville": "Vl","Vill": "Vlg","Village": "Vlg","Villages": "Vlgs","Valley": "Vly","Valleys": "Vlys","Village Post Office": "Vpo","View": "Vw","Views": "Vws","West": "W","Wharf": "Whrf","Walkway": "Wkwy","Cr": "X","Cres": "X","Crss": "X","Cross": "X","Crescent": "X","Crossing": "Xing","P\\.?\\ ?O\\.? Box [0-9]+": "","Suite [0-9]+": "","Suite [a-z]": "","STE [0-9]+": "","STE [a-z]": ""
        });
    })
    .add('SPLIT (2): filtering tokens', function() {
        token.tokenReplacerFilter(replacer,'North Main Street');
    })
    .add('SPLIT (3): Permutation of US index tokens with a query regex', function() {
        assert.deepEqual(termops.replaceTokenPermutations(replacer, 'Suite 123 North Main Street').sort(), [ ' N Main St',' North Main St',' North Main Street','Suite 123 N Main St','Suite 123 N Main Street','Suite 123 North Main St','Suite 123 North Main Street' ].sort());
    })
    .on('cycle', function(event) {
        console.log(String(event.target));
    })
    .on('complete', function() {
        cb(null, suite);
    })
    .run();
}

if (!process.env.runSuite) benchmark();